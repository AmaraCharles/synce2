"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[10640],{95370:(t,e,i)=>{i.d(e,{PanePriceAxisView:()=>a});var n=i(5486);class s{constructor(t){this._priceAxisViewRenderer=null,this._rendererOptions=null,this._align="right",this._textWidthCache=t}setParams(t,e,i,n,s){this._priceAxisViewRenderer=t,this._rendererOptions=e,this._align=s}draw(t,e){null!==this._rendererOptions&&null!==this._priceAxisViewRenderer&&this._priceAxisViewRenderer.draw(t,e,this._rendererOptions,this._textWidthCache,this._align)}hitTest(t,e){return void 0===this._priceAxisViewRenderer?.hitTest?null:this._priceAxisViewRenderer?.hitTest(t,e,this._align)}}class a{constructor(t,e,i){this._renderer=null,this._invalidated=!0,this._priceAxisView=t,this._textWidthCache=new n.TextWidthCache(100),this._dataSource=e,this._chartModel=i,this._fontSize=-1,this._panePriceAxisViewRenderer=new s(this._textWidthCache)}update(t){this._invalidated=!0}renderer(t){return this._invalidated&&this._updateImpl(t),this._renderer}_position(){const t=this._chartModel.crossHairSource(),e=this._dataSource===t?t.pane:this._chartModel.paneForSource(this._dataSource);if(null===e)return null;const i=this._priceScale();if(null===i)return null;let n=e.priceScalePosition(i);return"overlay"===n&&(n=e.priceScalePosition(e.defaultPriceScale())),"overlay"===n?null:n}_updateImpl(t){this._renderer=null;const e=this._position();if(null===e)return;const i=this._chartModel.priceAxisRendererOptions();i.fontSize!==this._fontSize&&(this._fontSize=i.fontSize,this._textWidthCache.reset()),this._panePriceAxisViewRenderer.setParams(this._priceAxisView.paneRenderer(),i,t.mediaSize.width,t.mediaSize.height,e),this._renderer=this._panePriceAxisViewRenderer,this._invalidated=!1}_priceScale(){return this._dataSource.priceScale()}}},403862:(t,e,i)=>{i.d(e,{PaneRendererArea:()=>r});var n=i(708698),s=i(286436),a=i(665798);class r extends n.PaneRendererLine{constructor(t){t.forceLineColor=!1,super(t)}_drawImpl(t){const e=this._data;if(0===e.items.length)return;let i=this._data.visibleItemsRange?.startItemIndex??0,r=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1;for(;i<r&&!(0,s.coordinateIsValid)(e.items[i].y);)i++;for(;r>=0&&!(0,s.coordinateIsValid)(e.items[r].y);)r--;if(i>r)return;const{context:l,horizontalPixelRatio:o,verticalPixelRatio:h}=t;l.save(),l.scale(o,h),l.lineCap="round",l.strokeStyle=e.lineColor,l.lineWidth=e.lineWidth,(0,a.setLineStyle)(l,e.lineStyle),l.lineWidth=1;const d={},c=new n.PaneRendererLineItemsIterator(this._data.items,i,r+1,this._data.skipHoles);for(;c.next();){const t=c.currentValue();let i;i=(0,n.isValidPoint)(t)&&t.style?t.style.color:e.lineColor;const s=c.nextValue();if((0,n.isValidPoint)(s)&&s?.style){const e=s.style.color;if(i!==e){const i=d[e]||[];i.push(t),d[e]=i}}const a=d[i]||[];a.push(t),d[i]=a}for(const t of Object.keys(d)){const i=d[t];l.beginPath();let s=0;for(let a=0;a<i.length;a++){const r=i[a];(0,n.isValidPoint)(r)&&(r.style&&r.style?.color!==t&&(l.moveTo(Math.round(i[s].center),e.bottom),
this._walkLine(l,i.slice(s,a),!0,e.bottom,!0),s=a))}if(l.moveTo(Math.round(i[s].center),e.bottom),this._walkLine(l,i.slice(s,i.length),!0,e.bottom,!0),l.closePath(),e.isSeries){const t=l.createLinearGradient(0,0,0,e.bottom);t.addColorStop(0,e.color1),t.addColorStop(1,e.color2),l.fillStyle=t,e.simpleMode=!0}else l.fillStyle=t;l.fill()}l.lineWidth=e.lineWidth,l.restore(),super._drawImpl(t)}}},708698:(t,e,i)=>{i.d(e,{PaneRendererLine:()=>_,PaneRendererLineItemsIterator:()=>u,isValidPoint:()=>c});var n=i(650151),s=i(86441),a=i(204652),r=i(509078),l=i(286436),o=i(665798),h=i(961970);const d={y:NaN};function c(t){return null!==t&&!isNaN(t.y)}class u{constructor(t,e,i,s){this._calculatedPrev={index:null,currentBreakProcessed:!1,value:null},this._calculatedCurrent={index:null,currentBreakProcessed:!1,value:null},this._calculatedNext={index:null,currentBreakProcessed:!1,value:null},this._preallocatedVariable={index:null,currentBreakProcessed:!1,value:null},t.length&&((0,n.assert)(e<=i,"First index must be less or equal to last index"),(0,n.assert)(e<t.length,"First index must be less then array length"),(0,n.assert)(i<=t.length,"Last index must be less or equal to array length")),this._items=t,this._firstIndexWithRange=e,this._lastIndexWithRange=i,this._skipHoles=s}next(){if(0===this._items.length)return!1;if(null!==this._calculatedNext.index)return null!==this._calculatedNext.value&&(this._calculatedPrev=this._calculatedCurrent,this._calculatedCurrent=this._calculatedNext,this._calculatedNext={index:null,currentBreakProcessed:!1,value:null},!0);let t;this._preallocatedVariable={...this._calculatedCurrent};do{null===this._preallocatedVariable.index?(this._preallocatedVariable.index=this._firstIndexWithRange,this._preallocatedVariable.currentBreakProcessed=!1,t=this._preallocatedVariable.index<this._lastIndexWithRange):(this._incrementPointer(this._preallocatedVariable),t=this._isValidPointer(this._preallocatedVariable)),t&&this._calcVaue(this._preallocatedVariable)}while(t&&this._skipHoles&&!c(this._preallocatedVariable.value));return t&&(this._calculatedPrev=this._calculatedCurrent,this._calculatedCurrent=this._preallocatedVariable,this._calculatedNext={index:null,currentBreakProcessed:!1,value:null}),t}prevValue(){return this._calculatedPrev.value}currentValue(){return(0,n.ensureNotNull)(this._calculatedCurrent.value)}currentValueIsLast(){return(0,n.ensureNotNull)(this._calculatedCurrent.index)===this._items.length-1}currentValueIsFirst(){return 0===(0,n.ensureNotNull)(this._calculatedCurrent.index)}nextValue(){if(null!==this._calculatedNext.index)return this._calculatedNext.value;let t;this._calculatedNext={...this._calculatedCurrent,value:null};do{this._incrementPointer(this._calculatedNext),t=this._isValidPointer(this._calculatedNext),t?this._calcVaue(this._calculatedNext):this._calculatedNext.value=null}while(t&&this._skipHoles&&!c(this._calculatedNext.value));return this._calculatedNext.value}atStart(){return this._calculatedCurrent.index===this._firstIndexWithRange&&!this._calculatedCurrent.currentBreakProcessed}
atEnd(){const t=(0,n.ensureNotNull)(this._calculatedCurrent.index);return t<this._lastIndexWithRange&&(this._calculatedCurrent.currentBreakProcessed||!this._needBreakBefore(t))}_needBreakBefore(t){return!!this._items[t].breakBefore&&!this._skipHoles}_calcVaue(t){const e=(0,n.ensureNotNull)(t.index);this._needBreakBefore(e)&&!t.currentBreakProcessed?t.value=d:t.value=this._items[e]}_incrementPointer(t){const e=(0,n.ensureNotNull)(t.index);this._needBreakBefore(e)&&!this._calculatedCurrent.currentBreakProcessed?t.currentBreakProcessed=!0:(t.index=e+1,t.currentBreakProcessed=!1)}_isValidPointer(t){const e=(0,n.ensureNotNull)(t.index);return e<this._lastIndexWithRange||e===this._lastIndexWithRange-1&&this._needBreakBefore(e)&&t.currentBreakProcessed}}class _ extends h.BitmapCoordinatesPaneRenderer{constructor(t){super(),this._data=t}hitTest(t){const e=(0,l.interactionTolerance)().series+this._data.lineWidth/2;let i=this._data.visibleItemsRange?.startItemIndex??0,n=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1;for(;n-i>2;){const e=Math.round((n+i)/2);this._data.items[e].center<=t.x?i=e:n=e}i=Math.max(1,i-1),n=Math.min(this._data.items.length-1,n+1);for(let l=i;l<=n;++l){const i=this._data.items[l-1],n=this._data.items[l],o=i.center,h=n.center;if((0,a.distanceToSegment)(new s.Point(o,i.y),new s.Point(h,n.y),new s.Point(t.x,t.y)).distance<=e)return this._data.hittest?this._data.hittest:new r.HitTestResult(r.HitTarget.Regular)}return null}_drawImpl(t){const{context:e,horizontalPixelRatio:i,verticalPixelRatio:n}=t;e.scale(i,n),e.lineCap="round",e.lineJoin="round",e.strokeStyle=this._data.lineColor,e.fillStyle=this._data.lineColor,e.lineWidth=this._data.lineWidth,(0,o.setLineStyle)(e,this._data.lineStyle),(0,l.setValidLineStyle)(e,this._data.lineStyle),this._data.simpleMode?this._drawSimpleMode(e,i,n):this._drawLines(e)}_drawSimpleMode(t,e,i){t.beginPath(),this._walkLine(t,this._data.items,!1,NaN),t.stroke();const n=this._data.lineWidth+2;if(this._data.withMarkers&&2*n<this._data.barSpacing){t.scale(1/e,1/i);const s=Math.max(1,Math.floor(e))%2/2,a=n*i+s,r=2*Math.PI;t.beginPath();const l=this._data.visibleItemsRange?.startItemIndex??0;for(let n=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1+1;n-- >=l;){const l=this._data.items[n];if(l){const n=Math.round(l.center*e)+s,o=l.y*i;t.moveTo(n,o),t.arc(n,o,a,0,r)}}t.fill()}}_walkLine(t,e,i,n,s){if(!e)return;const a=.25*this._data.barSpacing;let r,l,o=null;const h=s?0:this._data.visibleItemsRange?.startItemIndex??0,d=s?e.length:Math.min(this._data.visibleItemsRange?.endItemIndex??e.length,e.length);if(h>d||h>=e.length)return;const _=new u(e,h,d,this._data.skipHoles);for(;_.next();){if(r=_.currentValue(),l=_.nextValue(),c(r)){const e=Math.round(r.center);o&&c(o)?(t.lineTo(e,r.y),i&&!c(l)&&t.lineTo(e,n)):l&&c(l)?i?(_.atStart()||t.lineTo(e,n),t.lineTo(e,r.y)):t.moveTo(e,r.y):i?(_.atStart()||t.lineTo(e-a,n),t.lineTo(e-a,r.y),t.lineTo(e+a,r.y),t.lineTo(e+a,n)):(t.moveTo(e-a,r.y),t.lineTo(e+a,r.y))}o=r}}_drawLines(t){
if(!this._data.items.length)return;let e,i,n=null;const s=.25*this._data.barSpacing;t.beginPath();const a=this._data.visibleItemsRange?.startItemIndex??0,r=this._data.visibleItemsRange?.endItemIndex??this._data.items.length;if(a>r||a>=this._data.items.length)return;const o=this._data.items[a];o&&t.moveTo(o.center,o.y);let h,d=t.strokeStyle,_=t.lineWidth;const f=new u(this._data.items,a,r,this._data.skipHoles);for(;f.next();){let a,r,o;n=f.prevValue(),e=f.currentValue(),i=f.nextValue();let u=!1;if(c(e)&&(e.style&&!this._data.forceLineColor?(a=e.style.color,r=e.style.width,o=e.style.style):(a=this._data.lineColor,r=this._data.lineWidth,o=this._data.lineStyle),this._data.ignorePaletteLineWidth&&(r=this._data.lineWidth),u=a!==d||r!==_||o!==h),u)if(d=a,_=r,h=o,t.stroke(),t.beginPath(),t.strokeStyle=a,t.lineWidth=r,(0,l.setValidLineStyle)(t,o),c(n))t.moveTo(n.center,n.y);else{const i=e;t.moveTo(i.center,i.y)}m=n,x=i,c(p=e)&&(c(m)?t.lineTo(p.center,p.y):x&&c(x)?t.moveTo(p.center,p.y):(t.moveTo(p.center-s,p.y),t.lineTo(p.center+s,p.y)))}var m,p,x;t.stroke()}}},810873:(t,e,i)=>{i.d(e,{PaneRendererStepLine:()=>p,StepLineDecoration:()=>n});var n,s=i(204652),a=i(86441),r=i(432059),l=i(509078),o=i(286436),h=i(665798),d=i(961970),c=i(708698);!function(t){t[t.None=0]="None",t[t.Diamonds=1]="Diamonds"}(n||(n={}));class u{constructor(t){this._forceExtendFirstBar=!!t}initialize(t,e,i){const{context:n,horizontalPixelRatio:s,verticalPixelRatio:a}=e,r=t.lineStyle;n.lineCap="butt",n.lineJoin="round";const l=Math.max(Math.floor(i.style?.width??t.lineWidth*s));void 0!==r&&(0,h.setLineStyle)(n,r);const o=l%2?.5:0;n.moveTo(Math.round(i.center*s)+o,Math.round(i.y*a)+o),n.strokeStyle=i.style?.color??t.lineColor,n.lineWidth=l}startFragment(t,e,i,n){t.beginPath();const s=i.firstItem&&i.extendToBarsEndings?e.center:e.left;t.moveTo(isNaN(s)?-50:s,e.y)}finishFragment(t,e,i){e&&i&&t.lineTo(e.left,i.y),t.stroke()}hitTest(t,e,i,n){if(!(0,c.isValidPoint)(e))return!1;const r=e.style?.width??t.lineWidth,l=(0,o.interactionTolerance)().series+r/2,{left:h,y:d}=e,u=isNaN(h)?-50:h;let _,f;return i&&(0,c.isValidPoint)(i)?(_=i.left,f=i.y):(_=e.right,f=e.y),!(u<n.x-l&&_<n.x-l||u>n.x+l&&_>n.x+l)&&((0,s.distanceToSegment)((0,a.point)(u,d),(0,a.point)(_,d),n).distance<l||d!==f&&(0,s.distanceToSegment)((0,a.point)(_,d),(0,a.point)(_,f),n).distance<l)}applyColor(t,e){t.strokeStyle=e}applyLineWidth(t,e){t.lineWidth=e}drawItem(t,e,i,n){const s=t.context;void 0!==n&&s.lineTo(e.left,n.y),s.lineTo(!i.firstItem||i.extendToBarsEndings||this._forceExtendFirstBar?e.left:e.center,e.y),s.lineTo(i.lastItem&&!i.extendToBarsEndings?e.center:e.right,e.y)}}class _{constructor(){this._lineWidth=1}initialize(t,e,i){const{context:n,horizontalPixelRatio:s}=e;this.applyColor(n,i.style?.color??t.lineColor),this._lineWidth=Math.max(Math.floor(i.style?.width??t.lineWidth*s))}startFragment(t,e,i,n){t.beginPath()}finishFragment(t){t.fill()}drawItem(t,e,i,n){if(i.valIsNotSameAsPrev&&!isNaN(e.left)){const i=t.context;i.save(),i.translate(e.left,e.y),i.rotate(Math.PI/4)
;const n=this._scaleByLineWidth(this._lineWidth);i.scale(n,n),this._drawItemRotatedAndTranslated(t),i.restore()}}applyLineWidth(t,e){this._lineWidth=e}hitTest(t,e,i,n){if(!e.valIsNotSameAsPrev)return!1;const s=n.subtract((0,a.point)(e.left,e.y));return this._hitTestTranslated(s,e.style?.width??t.lineWidth)}_scaleByLineWidth(t){return Math.sqrt(t)}}class f extends _{applyColor(t,e){t.fillStyle=e}_hitTestTranslated(t,e){return Math.abs(t.x)+Math.abs(t.y)<8*this._scaleByLineWidth(e)/2}_drawItemRotatedAndTranslated(t){(0,h.drawRoundRect)(t.context,-4,-4,8,8,2,!0)}}class m extends _{applyColor(t,e){t.fillStyle=(0,r.applyTransparency)(e,85)}_hitTestTranslated(t,e){return Math.abs(t.x)+Math.abs(t.y)<21*this._scaleByLineWidth(e)/2}_drawItemRotatedAndTranslated(t){(0,h.drawRoundRect)(t.context,-10.5,-10.5,21,21,5,!0)}}class p extends d.BitmapCoordinatesPaneRenderer{constructor(t){super(),this._data=null,this._data=t??null}setData(t){this._data=t}hitTest(t){const e=this._data;if(null===e||0===e.items.length)return null;const{items:i,visibleItemsRange:s,skipHoles:a}=e,r=s?.startItemIndex??0,o=s?.endItemIndex??i.length;if(o<=r)return null;const h=e.decoration===n.Diamonds?[new u,new m]:[new u];const d=new c.PaneRendererLineItemsIterator(i,r,o,a);for(;d.next();){const i=d.currentValue(),n=d.nextValue();for(const s of h)if((0,c.isValidPoint)(i)&&s.hitTest(e,i,(0,c.isValidPoint)(n)?n:null,t))return new l.HitTestResult(l.HitTarget.Regular)}return null}_drawImpl(t){if(null===this._data||0===this._data.items.length)return;(this._data.decoration===n.Diamonds?[new u(!0),new f,new m]:[new u]).forEach((e=>this._drawDecorationItem(t,e)))}_drawDecorationItem(t,e){if(null===this._data||0===this._data.items.length)return;const{lineWidth:i,lineColor:n,items:s,visibleItemsRange:a,skipHoles:r,extendToBarsEndings:l}=this._data,{context:o,horizontalPixelRatio:h,verticalPixelRatio:d}=t;let u=Math.max(Math.floor((s[0].style?.width??i)*h)),_=u%2?.5:0;e.initialize(this._data,t,s[0]);const f=a?.startItemIndex??0,m=a?.endItemIndex??s.length;if(m<=f)return;let p,x,g;o.beginPath(),e.applyColor(o,s[f].style?.color??n),e.applyLineWidth(o,u);let y=!1;const I=new c.PaneRendererLineItemsIterator(s,f,m,r);for(;I.next();){const s=I.currentValue();if(!(0,c.isValidPoint)(s)){p=void 0,y=!0;continue}const a=s.style?.color??n,r=s.style?.width??i,f=a!==x,m=r!==g,P={firstItem:I.currentValueIsFirst(),lastItem:I.currentValueIsLast(),extendToBarsEndings:l,valIsNotSameAsPrev:s.valIsNotSameAsPrev},v={y:Math.round(s.y*d)+_,left:Math.round(s.left*h)+_,center:Math.round(s.center*h)+_,right:Math.round(s.right*h)+_};(f||m||y)&&(x&&g&&e.finishFragment(o,v,p),f&&e.applyColor(o,a),m&&(u=Math.max(1,Math.floor(r*h)),_=u%2?.5:0,e.applyLineWidth(o,u)),e.startFragment(o,v,P,p),y=!1,x=a,g=r),e.drawItem(t,v,P,p),p=v}e.finishFragment(o)}}},836687:(t,e,i)=>{i.d(e,{SelectionIndexes:()=>s});var n=i(650151);class s{constructor(t){this._baseIndex=null,this._offsetInBar=null,this._offsetInTime=null,this._barsBetweenPoints=null,this._timescale=t}indexes(){
const t=this._timescale.visibleBarsStrictRange();if(null===t)return[];const e=t.firstBar(),i=t.lastBar();if(null===this._offsetInTime||null===this._barsBetweenPoints){const t=this._timescale.barSpacing();this._barsBetweenPoints=Math.floor(120/t),this._offsetInBar=i%this._barsBetweenPoints,this._offsetInTime=this._timescale.indexToTimePoint(this._offsetInBar),this._baseIndex=this._timescale.baseIndex()}const s=this._timescale.baseIndex();this._baseIndex!==s&&(this._baseIndex=s,this._offsetInBar=(0,n.ensureNotNull)(this._timescale.timePointToIndex(this._offsetInTime)));const a=(0,n.ensureNotNull)(this._offsetInBar),r=[];let l=Math.floor((e-a)/this._barsBetweenPoints);const o=Math.floor((i-a)/this._barsBetweenPoints);for(;l<=o;l++)r.push(a+l*this._barsBetweenPoints);return r}clear(){this._offsetInBar=null,this._offsetInTime=null,this._baseIndex=null,this._barsBetweenPoints=null}}},112377:(t,e,i)=>{i.d(e,{SelectionRenderer:()=>h});var n=i(934026),s=i(790188),a=i(509078),r=i(86e3),l=i(961970);const o=s.colorsPalette["color-tv-blue-600"];class h extends l.BitmapCoordinatesPaneRenderer{constructor(t){super(),this._data=t||null}setData(t){this._data=t}hitTest(t){if(!this._data||!this._data.visible)return null;for(let e=0;e<this._data.points.length;e++){const i=this._data.points[e];if(i.point.subtract(t).length()<=5.5)return new a.HitTestResult(this._data.hittestResult,{pointIndex:i.pointIndex,cursorType:i.cursorType??r.PaneCursorType.Default})}return null}doesIntersectWithBox(t){return!!this._data&&this._data.points.some((e=>(0,n.pointInBox)(e.point,t)))}_drawImpl(t){if(null===this._data||!this._data.visible)return;const{context:e,horizontalPixelRatio:i}=t;e.strokeStyle=void 0!==this._data.color?this._data.color:o,e.lineCap="butt";const n=Math.max(1,Math.floor(i));e.lineWidth=n;const s=this._data.vertOffset||0;for(let i=0;i<this._data.points.length;++i){const r=this._data.points[i];(a=r.point,Number.isFinite(a.x)&&Number.isFinite(a.y))&&(e.fillStyle=this._data.bgColors[i],this._drawMarker(t,{center:r.point.x,y:r.point.y},s,n))}var a}_drawMarker(t,e,i,n){const{context:s,horizontalPixelRatio:a,verticalPixelRatio:r}=t;let l=Math.round(3.5*a*2);l%2!=n%2&&(l+=1);let o=Math.round(l+2*(.5*n+.75*a));o%2!=n%2&&(o+=1);const h=Math.round(e.center*a),d=Math.round((e.y+i)*r),c=n%2/2;s.beginPath(),s.arc(h+c,d+c,o/2,0,2*Math.PI,!0),s.closePath(),s.fill(),s.beginPath(),s.arc(h+c,d+c,l/2,0,2*Math.PI,!0),s.closePath(),s.stroke()}}},40563:(t,e,i)=>{function n(t){t.lineWidth=void 0,t.lineStyle=void 0;for(let e=0;e<t.colors.length;e++)t.colors[e]=void 0;return t}function s(){return{colors:[void 0,void 0,void 0,void 0,void 0,void 0,void 0],lineWidth:void 0,lineStyle:void 0}}i.d(e,{clearStyle:()=>n,createEmptyStyle:()=>s})},559678:(t,e,i)=>{i.d(e,{PaneRendererColumns:()=>a});var n=i(961970),s=i(509078);class a extends n.BitmapCoordinatesPaneRenderer{constructor(t){super(),this._data=null,this._precalculatedCache=[],this.setData(t)}setData(t){this._data=t,this._precalculatedCache=[]}hitTest(t){if(null===this._data)return null
;const e=this._data.visibleItemsRange?.startItemIndex??0,i=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1;for(let n=e;n<=i;n++){const e=this._data.items[n];if(t.x>=e.left&&t.x<=e.right){const i=e.y;if(t.y>=Math.min(i,this._data.histogramBase)&&t.y<=Math.max(i,this._data.histogramBase))return new s.HitTestResult(s.HitTarget.Regular)}}return null}_drawImpl(t){if(null===this._data||0===this._data.items.length)return;const{context:e,horizontalPixelRatio:i,verticalPixelRatio:n}=t;this._precalculatedCache.length||this._fillPrecalculatedCache(i);const s=Math.max(1,Math.floor(i)),a=Math.max(1,Math.floor(n)),r=Math.round(this._data.histogramBase*n)-Math.floor(s/2),l=r+s,o=this._data.lineColor,h=this._data.visibleItemsRange?.startItemIndex??0,d=(this._data.visibleItemsRange?.endItemIndex??this._data.items.length)-1;for(let t=h;t<=d;t++){const i=this._data.items[t],s=this._precalculatedCache[t-h],d=Math.round(i.y*n);let c,u;e.fillStyle=i.style?i.style.color:o,d<=r?(c=d,u=l):(c=r,u=d-Math.floor(a/2)+a),e.fillRect(s.left,c,s.right-s.left+1,u-c)}}_fillPrecalculatedCache(t){if(null===this._data||0===this._data.items.length)return void(this._precalculatedCache=[]);const{barSpacing:e,visibleItemsRange:i,items:n}=this._data,s=Math.ceil(e*t)<=1?0:Math.max(1,Math.floor(t)),a=i?.startItemIndex??0,r=(i?.endItemIndex??n.length)-1,l=r-a+1;if(l<=0)return void(this._precalculatedCache=[]);this._precalculatedCache=new Array(l);for(let e=a;e<=r;e++){const i=n[e],r=Math.round(i.center*t);let l,o;const h=Math.round((i.right-i.left)*t)-s;if(h%2){const t=(h-1)/2;l=r-t,o=r+t}else{const t=h/2;l=r-t,o=r+t-1}this._precalculatedCache[e-a]={left:l,right:o,roundedCenter:r,center:i.center*t,time:i.timePointIndex}}for(let t=a+1;t<=r;t++){const e=this._precalculatedCache[t-a],i=this._precalculatedCache[t-a-1];e.time===i.time+1&&(e.left-i.right!==s+1&&(i.roundedCenter>i.center?i.right=e.left-s-1:e.left=i.right+s+1))}let o=Math.ceil(e*t);for(let t=a+1;t<=r;t++){const e=this._precalculatedCache[t-a];e.right<e.left&&(e.right=e.left);const i=e.right-e.left+1;o=Math.min(i,o)}if(s>0&&o<4)for(let t=a+1;t<=r;t++){const e=this._precalculatedCache[t-a];e.right-e.left+1>o&&(e.roundedCenter>e.center?e.right-=1:e.left+=1)}}}},962973:(t,e,i)=>{i.d(e,{createStudyPlotColorProvider:()=>_});var n=i(748947),s=i(650151),a=i(40563);const r=new Map([[0,"color"],[2,"textColor"],[3,"borderColor"],[4,"wickColor"],[5,"colorup"],[6,"colordown"]]);class l{constructor(t){this._plotStyle=t}getPlotPointStyle(t,e){const i=e?(0,a.clearStyle)(e):(0,a.createEmptyStyle)();return r.forEach(((t,e)=>{this._plotStyle[t]&&(i.colors[e]=this._plotStyle[t].value())})),i.lineWidth=this._plotStyle.linewidth?this._plotStyle.linewidth.value():void 0,i.lineStyle=this._plotStyle.linestyle?this._plotStyle.linestyle.value():void 0,i}isColorDefined(){return!0}singleColor(){return!0}getDefaultPlotPointStyle(){return null}}const o=[0,1,2,3,4,5,6];class h{constructor(t,e,i,n){this._palettesColors=new Map,this._defaultPlotColors=new Map,this._indexes=n;const a=e.styles[i]
;if(a)for(const[t,e]of r)this._defaultPlotColors.set(t,a[e]);const l=(0,s.ensureDefined)(t.palettes),o=t.plots;n.forEach(((t,i)=>{const n=o[t];if(n&&"palette"in n){const t=l[n.palette],s=e.palettes[n.palette];if(t&&s){const{valToIndex:e}=t,{colors:n}=s,a={...n};e&&Object.keys(e).forEach((t=>{const i=e[t];void 0!==i&&(a[t]=n[i])})),this._palettesColors.set(i,a)}}}))}getPlotPointStyle(t,e){const i=e?(0,a.clearStyle)(e):(0,a.createEmptyStyle)();return o.forEach((e=>{if(this._palettesColors.has(e)){const n=t[(0,s.ensureDefined)(this._indexes.get(e))+1];if("number"==typeof n){const t=this._palettesColors.get(e)?.[n];0===e&&t&&(i.lineWidth=t.width.value(),i.lineStyle=t.style.value()),i.colors[e]=t?.color.value()}else i.colors[e]="transparent"}else i.colors[e]=this._defaultPlotColors.get(e)?.value()})),i}getDefaultPlotPointStyle(){const t=this._palettesColors.get(0)?.[0];if(void 0!==t){return{colors:[t.color.value(),void 0,void 0,void 0,void 0,void 0,void 0],lineStyle:void 0,lineWidth:t.width.value()}}return null}isColorDefined(){return!!this._palettesColors.size}singleColor(){return!1}}var d=i(19932);class c{constructor(t){this._rgbaFromInteger=(0,d.rgbaFromIntegerCached)(),this._indexes=t}getPlotPointStyle(t,e){const i=e?(0,a.clearStyle)(e):(0,a.createEmptyStyle)();return this._indexes.forEach(((e,n)=>{const s=t[e+1];if(null!=s){const t=this._rgbaFromInteger(s);i.colors[n]=t}else i.colors[n]="transparent"})),i}isColorDefined(){return!0}singleColor(){return!1}getDefaultPlotPointStyle(){return null}}const u=new Map([[0,function(t,e){const i=(0,n.isColorerPlot)(e)||(0,n.isOhlcColorerPlot)(e);return"target"in e&&e.target===t&&i}],[2,function(t,e){const i=(0,n.isTextColorerPlot)(e);return"target"in e&&e.target===t&&i}],[1,function(t,e){return(0,n.isBgColorerPlot)(e)&&e.id===t}],[3,function(t,e){const i=(0,n.isCandleBorderColorerPlot)(e);return"target"in e&&e.target===t&&i}],[4,function(t,e){const i=(0,n.isCandleWickColorerPlot)(e);return"target"in e&&e.target===t&&i}],[5,function(t,e){const i=(0,n.isUpColorerPlot)(e);return"target"in e&&e.target===t&&i}],[6,function(t,e){const i=(0,n.isDownColorerPlot)(e);return"target"in e&&e.target===t&&i}]]);function _(t,e,i){const{colorers:n}=function(t,e){const i=t.plots,n=i.findIndex((t=>t.id===e)),s=new Map;return i.forEach(((t,i)=>{u.forEach(((n,a)=>{n(e,t)&&s.set(a,i)}))})),{plotIndex:-1===n?null:n,colorers:s}}(t,i);if(n.size)return t.isRGB?new c(n):new h(t,e,i,n);{const t=e.ohlcPlots;if(t&&t[i])return new l(t[i]);const n=e.styles[i];return new l(n)}}},19932:(t,e,i)=>{i.d(e,{rgbaFromIntegerCached:()=>r});var n=i(259332),s=i(432059),a=i(211414);function r(t=1e3){const e=n.default.Cache;n.default.Cache=a.CircularCacheBuffer.bind(a.CircularCacheBuffer,t);const i=(0,n.default)(s.rgbaFromInteger);return n.default.Cache=e,i}},199872:(t,e,i)=>{function n(t,e){const i=new Map;return function(...n){const s=""+(e?e.apply(null,n):n[0]);if(!i.has(s)){const e=t.apply(this,n);return i.set(s,e),e}return i.get(s)}}i.d(e,{memoize:()=>n})}}]);